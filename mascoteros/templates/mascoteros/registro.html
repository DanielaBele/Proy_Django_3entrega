{% extends 'mascoteros/base.html' %}

{% block title %}Registro de Usuario{% endblock %}
{% block content %}

<h2>{% if modo_edicion %}Editar Dueño{% else %}Registrar Dueño{% endif %}</h2>

{% if modo_edicion %}
  <div class="alert alert-info mb-2">
    Estás editando al dueño con ID {{ dueño_id }}.
    <a href="{% url 'registro' %}" class="btn btn-sm btn-secondary">Cancelar edición</a>
  </div>
{% endif %}

<form method="post" action="{% if modo_edicion %}{% url 'editar_dueño' dueño_id %}{% else %}{% url 'registro' %}{% endif %}">
  {% csrf_token %}
  {{ dueño_form.as_p }}
  <button type="submit" class="btn btn-success">
    {% if modo_edicion %}Actualizar{% else %}Guardar{% endif %}
  </button>
</form>

{% if messages %}
  {% for message in messages %}
    <div class="alert alert-{{ message.tags }} alert-dismissible fade show mt-3" role="alert">
      {{ message }}
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Cerrar"></button>
    </div>
  {% endfor %}
{% endif %}

<hr>

<h2>Lista de Dueños Registrados</h2>
<ul class="list-group mt-3">
  {% for dueño in dueños %}
    <li class="list-group-item d-flex justify-content-between align-items-center">
      {{ dueño.nombre }} {{ dueño.apellido }} - {{ dueño.email }}
      <span>
        <!-- Botón Editar -->
        <a href="{% url 'editar_dueño' dueño.id %}" class="btn btn-sm btn-primary">Editar</a>

        <!-- Botón Eliminar -->
        <form method="post" action="{% url 'eliminar_dueño' dueño.id %}" style="display:inline;">
          {% csrf_token %}
          <button type="submit" class="btn btn-sm btn-danger">Eliminar</button>
        </form>
      </span>
    </li>
  {% empty %}
    <li class="list-group-item">No hay dueños registrados aún.</li>
  {% endfor %}
</ul>

{% endblock %}